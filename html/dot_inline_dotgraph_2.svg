<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: handle_frame Pages: 1 -->
<svg width="2278pt" height="291pt"
 viewBox="0.00 0.00 2277.50 291.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 287)">
<title>handle_frame</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-287 2273.5,-287 2273.5,4 -4,4"/>
<!-- Start -->
<g id="node1" class="node">
<title>Start</title>
<polygon fill="none" stroke="black" points="1106.5,-283 892.5,-283 892.5,-247 1106.5,-247 1106.5,-283"/>
<text text-anchor="middle" x="999.5" y="-261.3" font-family="Times,serif" font-size="14.00">handle_frame(cmd,payload)</text>
</g>
<!-- Switch -->
<g id="node2" class="node">
<title>Switch</title>
<polygon fill="none" stroke="black" points="999.5,-210 949.73,-192 999.5,-174 1049.27,-192 999.5,-210"/>
<text text-anchor="middle" x="999.5" y="-188.3" font-family="Times,serif" font-size="14.00">cmd?</text>
</g>
<!-- Start&#45;&gt;Switch -->
<g id="edge1" class="edge">
<title>Start&#45;&gt;Switch</title>
<path fill="none" stroke="black" d="M999.5,-246.81C999.5,-238.79 999.5,-229.05 999.5,-220.07"/>
<polygon fill="black" stroke="black" points="1003,-220.03 999.5,-210.03 996,-220.03 1003,-220.03"/>
</g>
<!-- GET_SYNC -->
<g id="node3" class="node">
<title>GET_SYNC</title>
<polygon fill="none" stroke="black" points="95,-123 0,-123 0,-87 95,-87 95,-123"/>
<text text-anchor="middle" x="47.5" y="-101.3" font-family="Times,serif" font-size="14.00">GET_SYNC</text>
</g>
<!-- Switch&#45;&gt;GET_SYNC -->
<g id="edge2" class="edge">
<title>Switch&#45;&gt;GET_SYNC</title>
<path fill="none" stroke="black" d="M954.88,-190.05C815.36,-186.88 388.53,-175.81 251.5,-156 201.32,-148.75 145.47,-134.62 104.92,-123.23"/>
<polygon fill="black" stroke="black" points="105.78,-119.84 95.21,-120.48 103.87,-126.57 105.78,-119.84"/>
<text text-anchor="middle" x="291" y="-144.8" font-family="Times,serif" font-size="14.00">GET_SYNC</text>
</g>
<!-- LOAD_ADDRESS -->
<g id="node4" class="node">
<title>LOAD_ADDRESS</title>
<polygon fill="none" stroke="black" points="266,-123 129,-123 129,-87 266,-87 266,-123"/>
<text text-anchor="middle" x="197.5" y="-101.3" font-family="Times,serif" font-size="14.00">LOAD_ADDRESS</text>
</g>
<!-- Switch&#45;&gt;LOAD_ADDRESS -->
<g id="edge3" class="edge">
<title>Switch&#45;&gt;LOAD_ADDRESS</title>
<path fill="none" stroke="black" d="M952.65,-190.93C852.56,-190.19 610.69,-185.22 410.5,-156 362.13,-148.94 308.57,-136.34 267.26,-125.56"/>
<polygon fill="black" stroke="black" points="268.13,-122.17 257.57,-123.01 266.34,-128.94 268.13,-122.17"/>
<text text-anchor="middle" x="471" y="-144.8" font-family="Times,serif" font-size="14.00">LOAD_ADDRESS</text>
</g>
<!-- ENTER_PM -->
<g id="node5" class="node">
<title>ENTER_PM</title>
<polygon fill="none" stroke="black" points="485.5,-123 385.5,-123 385.5,-87 485.5,-87 485.5,-123"/>
<text text-anchor="middle" x="435.5" y="-101.3" font-family="Times,serif" font-size="14.00">ENTER_PM</text>
</g>
<!-- Switch&#45;&gt;ENTER_PM -->
<g id="edge4" class="edge">
<title>Switch&#45;&gt;ENTER_PM</title>
<path fill="none" stroke="black" d="M954.05,-190.42C878.21,-188.71 721.33,-182.03 591.5,-156 556.8,-149.04 518.98,-137.04 489.26,-126.53"/>
<polygon fill="black" stroke="black" points="490.11,-123.12 479.52,-123.04 487.75,-129.71 490.11,-123.12"/>
<text text-anchor="middle" x="666.5" y="-144.8" font-family="Times,serif" font-size="14.00">ENTER_PROGMODE</text>
</g>
<!-- LEAVE_PM -->
<g id="node6" class="node">
<title>LEAVE_PM</title>
<polygon fill="none" stroke="black" points="716,-123 619,-123 619,-87 716,-87 716,-123"/>
<text text-anchor="middle" x="667.5" y="-101.3" font-family="Times,serif" font-size="14.00">LEAVE_PM</text>
</g>
<!-- Switch&#45;&gt;LEAVE_PM -->
<g id="edge5" class="edge">
<title>Switch&#45;&gt;LEAVE_PM</title>
<path fill="none" stroke="black" d="M961.6,-187.64C918.16,-183.14 845.15,-173.61 784.5,-156 759.28,-148.68 732.24,-137.37 710.52,-127.36"/>
<polygon fill="black" stroke="black" points="711.79,-124.09 701.25,-123.02 708.82,-130.43 711.79,-124.09"/>
<text text-anchor="middle" x="858" y="-144.8" font-family="Times,serif" font-size="14.00">LEAVE_PROGMODE</text>
</g>
<!-- CHIP_ERASE -->
<g id="node7" class="node">
<title>CHIP_ERASE</title>
<polygon fill="none" stroke="black" points="976.5,-123 864.5,-123 864.5,-87 976.5,-87 976.5,-123"/>
<text text-anchor="middle" x="920.5" y="-101.3" font-family="Times,serif" font-size="14.00">CHIP_ERASE</text>
</g>
<!-- Switch&#45;&gt;CHIP_ERASE -->
<g id="edge6" class="edge">
<title>Switch&#45;&gt;CHIP_ERASE</title>
<path fill="none" stroke="black" d="M979.13,-181.21C968.11,-175.14 954.88,-166.49 945.5,-156 939.36,-149.14 934.34,-140.49 930.45,-132.33"/>
<polygon fill="black" stroke="black" points="933.63,-130.86 926.4,-123.11 927.21,-133.67 933.63,-130.86"/>
<text text-anchor="middle" x="993.5" y="-144.8" font-family="Times,serif" font-size="14.00">CHIP_ERASE</text>
</g>
<!-- PROG_PAGE -->
<g id="node8" class="node">
<title>PROG_PAGE</title>
<polygon fill="none" stroke="black" points="1136.5,-123 1030.5,-123 1030.5,-87 1136.5,-87 1136.5,-123"/>
<text text-anchor="middle" x="1083.5" y="-101.3" font-family="Times,serif" font-size="14.00">PROG_PAGE</text>
</g>
<!-- Switch&#45;&gt;PROG_PAGE -->
<g id="edge7" class="edge">
<title>Switch&#45;&gt;PROG_PAGE</title>
<path fill="none" stroke="black" d="M1014.83,-179.3C1023.05,-172.78 1033.16,-164.31 1041.5,-156 1049.21,-148.32 1057.04,-139.37 1063.83,-131.18"/>
<polygon fill="black" stroke="black" points="1066.62,-133.29 1070.21,-123.32 1061.19,-128.87 1066.62,-133.29"/>
<text text-anchor="middle" x="1100.5" y="-144.8" font-family="Times,serif" font-size="14.00">PROG_PAGE</text>
</g>
<!-- READ_PAGE -->
<g id="node9" class="node">
<title>READ_PAGE</title>
<polygon fill="none" stroke="black" points="1342,-123 1237,-123 1237,-87 1342,-87 1342,-123"/>
<text text-anchor="middle" x="1289.5" y="-101.3" font-family="Times,serif" font-size="14.00">READ_PAGE</text>
</g>
<!-- Switch&#45;&gt;READ_PAGE -->
<g id="edge8" class="edge">
<title>Switch&#45;&gt;READ_PAGE</title>
<path fill="none" stroke="black" d="M1029.93,-184.96C1060.42,-178.66 1108.58,-168.04 1149.5,-156 1178.48,-147.47 1210.23,-136.29 1236.15,-126.67"/>
<polygon fill="black" stroke="black" points="1237.65,-129.84 1245.78,-123.06 1235.19,-123.29 1237.65,-129.84"/>
<text text-anchor="middle" x="1237" y="-144.8" font-family="Times,serif" font-size="14.00">READ_PAGE</text>
</g>
<!-- READ_SIGN -->
<g id="node10" class="node">
<title>READ_SIGN</title>
<polygon fill="none" stroke="black" points="1583.5,-123 1479.5,-123 1479.5,-87 1583.5,-87 1583.5,-123"/>
<text text-anchor="middle" x="1531.5" y="-101.3" font-family="Times,serif" font-size="14.00">READ_SIGN</text>
</g>
<!-- Switch&#45;&gt;READ_SIGN -->
<g id="edge9" class="edge">
<title>Switch&#45;&gt;READ_SIGN</title>
<path fill="none" stroke="black" d="M1036.65,-187.4C1091.34,-181.88 1196.62,-170.45 1285.5,-156 1348.48,-145.76 1419.89,-130.88 1469.48,-120.01"/>
<polygon fill="black" stroke="black" points="1470.4,-123.4 1479.41,-117.83 1468.89,-116.56 1470.4,-123.4"/>
<text text-anchor="middle" x="1411.5" y="-144.8" font-family="Times,serif" font-size="14.00">READ_SIGN</text>
</g>
<!-- UNIVERSAL -->
<g id="node11" class="node">
<title>UNIVERSAL</title>
<polygon fill="none" stroke="black" points="1804,-123 1699,-123 1699,-87 1804,-87 1804,-123"/>
<text text-anchor="middle" x="1751.5" y="-101.3" font-family="Times,serif" font-size="14.00">UNIVERSAL</text>
</g>
<!-- Switch&#45;&gt;UNIVERSAL -->
<g id="edge10" class="edge">
<title>Switch&#45;&gt;UNIVERSAL</title>
<path fill="none" stroke="black" d="M1041.49,-189.12C1122.54,-185.21 1306.09,-174.93 1459.5,-156 1539.12,-146.18 1630.11,-129.76 1689.07,-118.44"/>
<polygon fill="black" stroke="black" points="1689.81,-121.86 1698.97,-116.52 1688.49,-114.98 1689.81,-121.86"/>
<text text-anchor="middle" x="1601" y="-144.8" font-family="Times,serif" font-size="14.00">UNIVERSAL</text>
</g>
<!-- DEFAULT -->
<g id="node12" class="node">
<title>DEFAULT</title>
<polygon fill="none" stroke="black" points="2053.5,-123 1967.5,-123 1967.5,-87 2053.5,-87 2053.5,-123"/>
<text text-anchor="middle" x="2010.5" y="-101.3" font-family="Times,serif" font-size="14.00">DEFAULT</text>
</g>
<!-- Switch&#45;&gt;DEFAULT -->
<g id="edge11" class="edge">
<title>Switch&#45;&gt;DEFAULT</title>
<path fill="none" stroke="black" d="M1043.73,-189.9C1148.93,-187 1422.26,-177.82 1649.5,-156 1759.35,-145.45 1887.1,-126.07 1957.35,-114.78"/>
<polygon fill="black" stroke="black" points="1957.98,-118.23 1967.29,-113.18 1956.86,-111.32 1957.98,-118.23"/>
<text text-anchor="middle" x="1799" y="-144.8" font-family="Times,serif" font-size="14.00">other</text>
</g>
<!-- RESP_OK -->
<g id="node13" class="node">
<title>RESP_OK</title>
<ellipse fill="none" stroke="black" cx="902.5" cy="-18" rx="77.19" ry="18"/>
<text text-anchor="middle" x="902.5" y="-14.3" font-family="Times,serif" font-size="14.00">send response</text>
</g>
<!-- GET_SYNC&#45;&gt;RESP_OK -->
<g id="edge12" class="edge">
<title>GET_SYNC&#45;&gt;RESP_OK</title>
<path fill="none" stroke="black" d="M47.46,-86.85C48.44,-75.65 51.75,-61.72 61.5,-54 90.69,-30.89 606.34,-22.4 815.46,-19.89"/>
<polygon fill="black" stroke="black" points="815.53,-23.39 825.49,-19.77 815.45,-16.39 815.53,-23.39"/>
<text text-anchor="middle" x="133.5" y="-57.8" font-family="Times,serif" font-size="14.00">Resp_INSYNC + OK</text>
</g>
<!-- LOAD_ADDRESS&#45;&gt;RESP_OK -->
<g id="edge13" class="edge">
<title>LOAD_ADDRESS&#45;&gt;RESP_OK</title>
<path fill="none" stroke="black" d="M201.05,-86.62C204.33,-75.32 210.44,-61.36 221.5,-54 269.72,-21.9 642.28,-18.43 815.04,-18.57"/>
<polygon fill="black" stroke="black" points="815.12,-22.07 825.13,-18.58 815.13,-15.07 815.12,-22.07"/>
<text text-anchor="middle" x="308.5" y="-57.8" font-family="Times,serif" font-size="14.00">set current_address; OK</text>
</g>
<!-- ENTER_PM&#45;&gt;RESP_OK -->
<g id="edge14" class="edge">
<title>ENTER_PM&#45;&gt;RESP_OK</title>
<path fill="none" stroke="black" d="M412.69,-86.77C401.93,-76.63 393.28,-63.89 402.5,-54 429.94,-24.58 678.66,-19.4 814.64,-18.79"/>
<polygon fill="black" stroke="black" points="815.04,-22.29 825.03,-18.75 815.02,-15.29 815.04,-22.29"/>
<text text-anchor="middle" x="517" y="-57.8" font-family="Times,serif" font-size="14.00">avr_enter_programming_mode()</text>
</g>
<!-- LEAVE_PM&#45;&gt;RESP_OK -->
<g id="edge15" class="edge">
<title>LEAVE_PM&#45;&gt;RESP_OK</title>
<path fill="none" stroke="black" d="M647.09,-86.72C637.52,-76.55 629.9,-63.81 638.5,-54 661.21,-28.08 747.02,-20.48 814.72,-18.65"/>
<polygon fill="black" stroke="black" points="815.08,-22.14 824.99,-18.41 814.91,-15.15 815.08,-22.14"/>
<text text-anchor="middle" x="768" y="-57.8" font-family="Times,serif" font-size="14.00">avr_leave_programming_mode(); OK</text>
</g>
<!-- CHIP_ERASE&#45;&gt;RESP_OK -->
<g id="edge16" class="edge">
<title>CHIP_ERASE&#45;&gt;RESP_OK</title>
<path fill="none" stroke="black" d="M910.3,-86.75C907.56,-81.26 904.95,-75.04 903.5,-69 901.78,-61.85 901.09,-53.97 900.93,-46.61"/>
<polygon fill="black" stroke="black" points="904.44,-46.39 901.03,-36.36 897.44,-46.32 904.44,-46.39"/>
<text text-anchor="middle" x="991.5" y="-57.8" font-family="Times,serif" font-size="14.00">avr_erase_memory(); OK</text>
</g>
<!-- PROG_PAGE&#45;&gt;RESP_OK -->
<g id="edge17" class="edge">
<title>PROG_PAGE&#45;&gt;RESP_OK</title>
<path fill="none" stroke="black" d="M1086.93,-86.69C1087.99,-76 1087.26,-62.71 1079.5,-54 1066.58,-39.5 1024.66,-30.83 984.85,-25.75"/>
<polygon fill="black" stroke="black" points="985.14,-22.26 974.8,-24.54 984.3,-29.21 985.14,-22.26"/>
<text text-anchor="middle" x="1201" y="-57.8" font-family="Times,serif" font-size="14.00">write page buffer + commit; OK</text>
</g>
<!-- READ_PAGE&#45;&gt;RESP_OK -->
<g id="edge18" class="edge">
<title>READ_PAGE&#45;&gt;RESP_OK</title>
<path fill="none" stroke="black" d="M1310.62,-86.63C1320.53,-76.43 1328.41,-63.69 1319.5,-54 1297.66,-30.25 1105.35,-22.61 989.66,-20.15"/>
<polygon fill="black" stroke="black" points="989.47,-16.65 979.4,-19.95 989.32,-23.65 989.47,-16.65"/>
<text text-anchor="middle" x="1451.5" y="-57.8" font-family="Times,serif" font-size="14.00">read N bytes; INSYNC + data + OK</text>
</g>
<!-- READ_SIGN&#45;&gt;RESP_OK -->
<g id="edge19" class="edge">
<title>READ_SIGN&#45;&gt;RESP_OK</title>
<path fill="none" stroke="black" d="M1567.25,-86.81C1582.33,-77.34 1594.2,-65.26 1583.5,-54 1563.37,-32.81 1168.82,-23.48 989.67,-20.33"/>
<polygon fill="black" stroke="black" points="989.54,-16.82 979.48,-20.15 989.42,-23.82 989.54,-16.82"/>
<text text-anchor="middle" x="1676" y="-57.8" font-family="Times,serif" font-size="14.00">INSYNC + 3 bytes + OK</text>
</g>
<!-- UNIVERSAL&#45;&gt;RESP_OK -->
<g id="edge20" class="edge">
<title>UNIVERSAL&#45;&gt;RESP_OK</title>
<path fill="none" stroke="black" d="M1764.7,-86.76C1771.18,-76.1 1775.96,-62.81 1767.5,-54 1740.88,-26.29 1204.68,-20.52 990.12,-19.31"/>
<polygon fill="black" stroke="black" points="989.86,-15.81 979.85,-19.26 989.83,-22.81 989.86,-15.81"/>
<text text-anchor="middle" x="1914.5" y="-57.8" font-family="Times,serif" font-size="14.00">4&#45;byte SPI xfer; INSYNC + 1 byte + OK</text>
</g>
<!-- RESP_FAIL -->
<g id="node14" class="node">
<title>RESP_FAIL</title>
<ellipse fill="none" stroke="black" cx="2137.5" cy="-18" rx="59.59" ry="18"/>
<text text-anchor="middle" x="2137.5" y="-14.3" font-family="Times,serif" font-size="14.00">send error</text>
</g>
<!-- DEFAULT&#45;&gt;RESP_FAIL -->
<g id="edge21" class="edge">
<title>DEFAULT&#45;&gt;RESP_FAIL</title>
<path fill="none" stroke="black" d="M2053.75,-97.95C2074.52,-93.12 2098.53,-84.47 2115.5,-69 2122.25,-62.85 2127.04,-54.25 2130.38,-45.91"/>
<polygon fill="black" stroke="black" points="2133.7,-47.01 2133.67,-36.41 2127.09,-44.71 2133.7,-47.01"/>
<text text-anchor="middle" x="2198" y="-57.8" font-family="Times,serif" font-size="14.00">FAILED or NOSYNC</text>
</g>
</g>
</svg>
